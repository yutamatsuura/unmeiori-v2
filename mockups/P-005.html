<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P-005: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®šãƒšãƒ¼ã‚¸ | sindankantei</title>
    
    <!-- MUI v5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/@mui/material@5.15.0/umd/material-ui.development.js" rel="prefetch">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    <style>
        /* ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãƒ†ãƒ¼ãƒè¨­å®š */
        :root {
            --primary-main: #34495e;
            --primary-light: #566573;
            --primary-dark: #2c3e50;
            --secondary-main: #bdc3c7;
            --secondary-light: #d5dbdb;
            --secondary-dark: #85929e;
            --success-main: #16a085;
            --success-light: #48c9b0;
            --warning-main: #f39c12;
            --error-main: #e74c3c;
            --background-default: #ffffff;
            --background-paper: #fafbfc;
            --text-primary: #2c3e50;
            --text-secondary: #566573;
            --text-disabled: #bdc3c7;
            --border-color: #d5dbdb;
            --shadow-1: 0 2px 4px rgba(52, 73, 94, 0.1);
            --shadow-2: 0 4px 8px rgba(52, 73, 94, 0.12);
            --shadow-3: 0 8px 16px rgba(52, 73, 94, 0.14);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Times New Roman", "Noto Serif JP", serif;
            background-color: var(--background-default);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .app-layout {
            display: flex;
            min-height: 100vh;
        }
        
        .sidebar {
            width: 280px;
            background-color: var(--background-paper);
            border-right: 1px solid var(--border-color);
            padding: 24px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }
        
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 32px;
            max-width: calc(100vw - 280px);
        }
        
        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .page-header {
            margin-bottom: 32px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 16px;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .page-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }
        
        /* ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .content-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            max-width: 1400px;
        }
        
        /* è¨­å®šã‚¨ãƒªã‚¢ */
        .settings-panel {
            background-color: var(--background-paper);
            border-radius: 8px;
            padding: 24px;
            box-shadow: var(--shadow-2);
        }
        
        .panel-title {
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--primary-main);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary-main);
            padding-bottom: 8px;
        }
        
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */
        .preview-panel {
            background-color: var(--background-paper);
            border-radius: 8px;
            padding: 24px;
            box-shadow: var(--shadow-2);
            position: sticky;
            top: 32px;
            max-height: calc(100vh - 64px);
            overflow-y: auto;
        }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s ease;
            background-color: var(--background-default);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 2px rgba(52, 73, 94, 0.1);
        }
        
        .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            background-color: var(--background-default);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .form-select:focus {
            outline: none;
            border-color: var(--primary-main);
            box-shadow: 0 0 0 2px rgba(52, 73, 94, 0.1);
        }
        
        /* ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ */
        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 32px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: var(--background-default);
        }
        
        .file-upload-area:hover {
            border-color: var(--primary-main);
            background-color: var(--background-paper);
        }
        
        .file-upload-area.dragover {
            border-color: var(--primary-main);
            background-color: var(--background-paper);
            box-shadow: var(--shadow-2);
        }
        
        .upload-icon {
            font-size: 48px;
            color: var(--text-disabled);
            margin-bottom: 16px;
        }
        
        .upload-text {
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .upload-hint {
            font-size: 0.75rem;
            color: var(--text-disabled);
        }
        
        .file-input {
            display: none;
        }
        
        /* ç¾åœ¨ã®ãƒ­ã‚´è¡¨ç¤º */
        .current-logo {
            margin-top: 16px;
            padding: 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--background-default);
        }
        
        .current-logo img {
            max-width: 200px;
            max-height: 100px;
            object-fit: contain;
        }
        
        /* ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ */
        .color-palette {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 8px;
        }
        
        .color-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .color-option:hover {
            border-color: var(--primary-main);
            box-shadow: var(--shadow-1);
        }
        
        .color-option.selected {
            border-color: var(--primary-main);
            background-color: var(--background-paper);
            box-shadow: var(--shadow-2);
        }
        
        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-bottom: 8px;
            border: 1px solid var(--border-color);
        }
        
        .color-name {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: center;
        }
        
        /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ */
        .font-size-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 8px;
        }
        
        .font-size-option {
            padding: 16px 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: var(--background-default);
        }
        
        .font-size-option:hover {
            border-color: var(--primary-main);
            box-shadow: var(--shadow-1);
        }
        
        .font-size-option.selected {
            border-color: var(--primary-main);
            background-color: var(--background-paper);
            box-shadow: var(--shadow-2);
        }
        
        .font-size-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 4px;
        }
        
        .font-size-example {
            color: var(--text-secondary);
        }
        
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é‘‘å®šæ›¸ */
        .preview-document {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 32px;
            background-color: var(--background-default);
            box-shadow: var(--shadow-1);
            margin-top: 16px;
        }
        
        .preview-header {
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--primary-main);
        }
        
        .preview-logo {
            max-width: 150px;
            max-height: 80px;
            object-fit: contain;
            margin-bottom: 16px;
        }
        
        .preview-business-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-main);
            margin-bottom: 8px;
        }
        
        .preview-operator-name {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }
        
        .preview-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .preview-content {
            margin-top: 24px;
        }
        
        .preview-section {
            margin-bottom: 24px;
        }
        
        .preview-section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-main);
            margin-bottom: 12px;
            border-left: 4px solid var(--success-main);
            padding-left: 12px;
        }
        
        .preview-text {
            color: var(--text-primary);
            line-height: 1.8;
        }
        
        /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .action-buttons {
            display: flex;
            gap: 16px;
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid var(--border-color);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: none;
        }
        
        .btn-primary {
            background-color: var(--primary-main);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow-2);
        }
        
        .btn-success {
            background-color: var(--success-main);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #138d75;
            box-shadow: var(--shadow-2);
        }
        
        .btn-secondary {
            background-color: var(--secondary-main);
            color: var(--text-primary);
        }
        
        .btn-secondary:hover {
            background-color: var(--secondary-dark);
            box-shadow: var(--shadow-2);
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 1200px) {
            .content-layout {
                grid-template-columns: 1fr;
                gap: 24px;
            }
            
            .preview-panel {
                position: static;
                max-height: none;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .main-content {
                margin-left: 0;
                padding: 16px;
                max-width: 100vw;
            }
            
            .content-layout {
                gap: 16px;
            }
            
            .settings-panel,
            .preview-panel {
                padding: 16px;
            }
        }
        
        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .nav-list {
            list-style: none;
        }
        
        .nav-item {
            margin: 0;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 24px;
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }
        
        .nav-link:hover {
            background-color: var(--background-paper);
            border-left-color: var(--primary-light);
        }
        
        .nav-link.active {
            background-color: var(--background-paper);
            border-left-color: var(--primary-main);
            color: var(--primary-main);
            font-weight: 600;
        }
        
        .nav-icon {
            margin-right: 12px;
            font-size: 20px;
        }
        
        .brand {
            padding: 0 24px 24px 24px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 24px;
        }
        
        .brand-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-main);
        }
        
        /* ã‚¢ãƒ©ãƒ¼ãƒˆ */
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            border: 1px solid;
        }
        
        .alert-success {
            background-color: #e8f5f3;
            border-color: var(--success-main);
            color: #138d75;
        }
        
        .alert-warning {
            background-color: #fef7e6;
            border-color: var(--warning-main);
            color: #d68910;
        }
    </style>
</head>
<body>
    <!--
    ã€CF_06å¼•ãç¶™ãæƒ…å ±ã€‘
    UIè¦ä»¶: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®šã®ç®¡ç†ï¼ˆãƒ­ã‚´ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€å±‹å·è¨­å®šã€åŸºæœ¬è‰²ãƒ»ãƒ•ã‚©ãƒ³ãƒˆé¸æŠã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼‰
    å¿…è¦API: 
    - GET /api/template/settings - ç¾åœ¨ã®è¨­å®šå–å¾—
    - PUT /api/template/update - è¨­å®šæ›´æ–°
    - POST /api/template/upload-logo - ãƒ­ã‚´ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    å…¥åŠ›ãƒ‡ãƒ¼ã‚¿: { 
        logo_file: File (JPG/PNG, max 2MB),
        business_name: string,
        operator_name: string,
        color_theme: string,
        font_size: string
    }
    å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿: { 
        success: boolean,
        logo_url: string,
        settings: TemplateSettingsResponse 
    }
    UIæ–‡è„ˆ: è¨­å®šå¤‰æ›´æ™‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°ã€ä¿å­˜å¾Œã®æˆåŠŸ/ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    ç‰¹è¨˜äº‹é …: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆFormDataï¼‰ã€ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ã€ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ
    -->
    
    <div class="app-layout">
        <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
        <nav class="sidebar">
            <div class="brand">
                <div class="brand-title">sindankantei</div>
            </div>
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-icons nav-icon">dashboard</span>
                        ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-icons nav-icon">description</span>
                        é‘‘å®šæ›¸ä½œæˆ
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-icons nav-icon">send</span>
                        ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»é€ä¿¡
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link">
                        <span class="material-icons nav-icon">history</span>
                        é‘‘å®šå±¥æ­´
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link active">
                        <span class="material-icons nav-icon">palette</span>
                        ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®š
                    </a>
                </li>
            </ul>
        </nav>
        
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
        <main class="main-content">
            <header class="page-header">
                <h1 class="page-title">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®š</h1>
                <p class="page-subtitle">é‘‘å®šæ›¸ã®ãƒ­ã‚´ãƒ»å±‹å·ãƒ»åŸºæœ¬ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ç‹¬è‡ªãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿç¾</p>
            </header>
            
            <div class="content-layout">
                <!-- è¨­å®šã‚¨ãƒªã‚¢ -->
                <div class="settings-panel">
                    <h2 class="panel-title">è¨­å®šé …ç›®</h2>
                    
                    <form id="templateSettingsForm">
                        <!-- ãƒ­ã‚´ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
                        <div class="form-group">
                            <label class="form-label">ãƒ­ã‚´ç”»åƒ</label>
                            <div class="file-upload-area" id="logoUploadArea">
                                <div class="upload-icon">ğŸ“·</div>
                                <div class="upload-text">ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ãƒ­ã‚´ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                                <div class="upload-hint">JPG, PNGå½¢å¼ / æœ€å¤§2MB</div>
                                <input type="file" id="logoFile" class="file-input" accept=".jpg,.jpeg,.png" />
                            </div>
                            
                            <!-- ç¾åœ¨ã®ãƒ­ã‚´è¡¨ç¤º -->
                            <div class="current-logo" id="currentLogo" style="display: none;">
                                <p style="margin-bottom: 8px; font-size: 0.875rem; color: var(--text-secondary);">ç¾åœ¨ã®ãƒ­ã‚´:</p>
                                <img id="currentLogoImg" alt="ç¾åœ¨ã®ãƒ­ã‚´" />
                                <button type="button" class="btn btn-secondary" style="margin-top: 8px; padding: 4px 8px; font-size: 0.75rem;" onclick="removeLogo()">å‰Šé™¤</button>
                            </div>
                        </div>
                        
                        <!-- å±‹å·ãƒ»äº‹æ¥­è€…å -->
                        <div class="form-group">
                            <label for="businessName" class="form-label">å±‹å·ãƒ»äº‹æ¥­æ‰€å</label>
                            <input type="text" id="businessName" class="form-input" value="å ã„ã‚µãƒ­ãƒ³ æ˜ŸèŠ±" placeholder="ä¾‹: å ã„ã‚µãƒ­ãƒ³ æ˜ŸèŠ±" />
                        </div>
                        
                        <!-- é‘‘å®šå£«å -->
                        <div class="form-group">
                            <label for="operatorName" class="form-label">é‘‘å®šå£«å</label>
                            <input type="text" id="operatorName" class="form-input" value="æ˜Ÿé‡ èŠ±å­" placeholder="ä¾‹: æ˜Ÿé‡ èŠ±å­" />
                        </div>
                        
                        <!-- åŸºæœ¬è‰²é¸æŠ -->
                        <div class="form-group">
                            <label class="form-label">åŸºæœ¬è‰²ãƒ†ãƒ¼ãƒ</label>
                            <div class="color-palette">
                                <div class="color-option selected" data-color="professional">
                                    <div class="color-preview" style="background-color: #34495e;"></div>
                                    <div class="color-name">ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«<br>ï¼ˆç´ºè‰²ï¼‰</div>
                                </div>
                                <div class="color-option" data-color="elegant">
                                    <div class="color-preview" style="background-color: #8b4513;"></div>
                                    <div class="color-name">ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆ<br>ï¼ˆèŒ¶è‰²ï¼‰</div>
                                </div>
                                <div class="color-option" data-color="modern">
                                    <div class="color-preview" style="background-color: #2c3e50;"></div>
                                    <div class="color-name">ãƒ¢ãƒ€ãƒ³<br>ï¼ˆãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼ï¼‰</div>
                                </div>
                                <div class="color-option" data-color="warm">
                                    <div class="color-preview" style="background-color: #d35400;"></div>
                                    <div class="color-name">ã‚¦ã‚©ãƒ¼ãƒ <br>ï¼ˆã‚ªãƒ¬ãƒ³ã‚¸ï¼‰</div>
                                </div>
                                <div class="color-option" data-color="nature">
                                    <div class="color-preview" style="background-color: #27ae60;"></div>
                                    <div class="color-name">ãƒŠãƒãƒ¥ãƒ©ãƒ«<br>ï¼ˆç·‘è‰²ï¼‰</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º -->
                        <div class="form-group">
                            <label class="form-label">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º</label>
                            <div class="font-size-options">
                                <div class="font-size-option" data-size="small">
                                    <div class="font-size-label">å°</div>
                                    <div class="font-size-example" style="font-size: 0.75rem;">èª­ã¿ã‚„ã™ã„</div>
                                </div>
                                <div class="font-size-option selected" data-size="medium">
                                    <div class="font-size-label">ä¸­</div>
                                    <div class="font-size-example" style="font-size: 0.875rem;">æ¨™æº–çš„</div>
                                </div>
                                <div class="font-size-option" data-size="large">
                                    <div class="font-size-label">å¤§</div>
                                    <div class="font-size-example" style="font-size: 1rem;">è¦‹ã‚„ã™ã„</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                        <div class="action-buttons">
                            <button type="submit" class="btn btn-success">
                                <span class="material-icons" style="font-size: 16px; margin-right: 8px; vertical-align: text-bottom;">save</span>
                                è¨­å®šã‚’ä¿å­˜
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                <span class="material-icons" style="font-size: 16px; margin-right: 8px; vertical-align: text-bottom;">refresh</span>
                                ãƒªã‚»ãƒƒãƒˆ
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
                <div class="preview-panel">
                    <h2 class="panel-title">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
                    <p style="color: var(--text-secondary); margin-bottom: 16px; font-size: 0.875rem;">
                        è¨­å®šã—ãŸå†…å®¹ãŒå®Ÿéš›ã®é‘‘å®šæ›¸ã§ã©ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‹ã‚’ç¢ºèªã§ãã¾ã™
                    </p>
                    
                    <div class="preview-document" id="previewDocument">
                        <div class="preview-header">
                            <div id="previewLogo" style="display: none;">
                                <img class="preview-logo" alt="ãƒ­ã‚´" />
                            </div>
                            <div class="preview-business-name" id="previewBusinessName">å ã„ã‚µãƒ­ãƒ³ æ˜ŸèŠ±</div>
                            <div class="preview-operator-name" id="previewOperatorName">é‘‘å®šå£«ï¼šæ˜Ÿé‡ èŠ±å­</div>
                            <h1 class="preview-title">ä¹æ˜Ÿæ°—å­¦é‘‘å®šæ›¸</h1>
                        </div>
                        
                        <div class="preview-content">
                            <div class="preview-section">
                                <h3 class="preview-section-title">ã”é‘‘å®šè€…æ§˜æƒ…å ±</h3>
                                <div class="preview-text">
                                    <p>ãŠåå‰ï¼šç”°ä¸­ å¤ªéƒ æ§˜</p>
                                    <p>ç”Ÿå¹´æœˆæ—¥ï¼šæ˜­å’Œ60å¹´3æœˆ15æ—¥</p>
                                    <p>æœ¬å‘½æ˜Ÿï¼šäºŒé»’åœŸæ˜Ÿ</p>
                                </div>
                            </div>
                            
                            <div class="preview-section">
                                <h3 class="preview-section-title">ä¹æ˜Ÿæ°—å­¦ã«ã‚ˆã‚‹æ€§æ ¼é‘‘å®š</h3>
                                <div class="preview-text">
                                    <p>ã‚ãªãŸã¯äºŒé»’åœŸæ˜Ÿã®ç”Ÿã¾ã‚Œã§ã€å¤§åœ°ã®ã‚ˆã†ãªåŒ…å®¹åŠ›ã¨å¿è€åŠ›ã‚’æŒã¤æ–¹ã§ã™ã€‚å‘¨å›²ã®äººã€…ã‹ã‚‰ä¿¡é ¼ã•ã‚Œã€é ¼ã‚Šã«ã•ã‚Œã‚‹å­˜åœ¨ã¨ã—ã¦æ´»èºã•ã‚Œã‚‹ã“ã¨ã§ã—ã‚‡ã†ã€‚</p>
                                    
                                    <p>ç‰¹ã«äººé–“é–¢ä¿‚ã«ãŠã„ã¦ã¯ã€ç›¸æ‰‹ã®æ°—æŒã¡ã‚’ç†è§£ã™ã‚‹èƒ½åŠ›ã«é•·ã‘ã¦ãŠã‚Šã€èª¿å’Œã‚’é‡ã‚“ã˜ã‚‹æ€§æ ¼ã§ã™ã€‚ä¸€æ–¹ã§ã€è‡ªåˆ†ã®æ„è¦‹ã‚’ã¯ã£ãã‚Šã¨è¿°ã¹ã‚‹ã“ã¨ãŒè‹¦æ‰‹ãªé¢ã‚‚ã‚ã‚Šã¾ã™ãŒ...</p>
                                </div>
                            </div>
                            
                            <div class="preview-section">
                                <h3 class="preview-section-title">å‰æ–¹ä½ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
                                <div class="preview-text">
                                    <p>2025å¹´ã®ã‚ãªãŸã®å‰æ–¹ä½ã¯<strong>åŒ—æ±æ–¹å‘</strong>ã§ã™ã€‚</p>
                                    <p>ç‰¹ã«3æœˆã€6æœˆã€9æœˆã¯ã“ã®æ–¹è§’ã¸ã®ç§»å‹•ãŒé–‹é‹ã«ã¤ãªãŒã‚Šã¾ã™ã€‚é‡è¦ãªæ±ºæ–­ã‚„æ–°ã—ã„ã“ã¨ã‚’å§‹ã‚ã‚‹éš›ã¯ã€ã“ã®æ–¹è§’ã‚’æ„è­˜ã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        // ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒã®å®šç¾©
        const colorThemes = {
            professional: { primary: '#34495e', accent: '#16a085', name: 'ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«' },
            elegant: { primary: '#8b4513', accent: '#d2691e', name: 'ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆ' },
            modern: { primary: '#2c3e50', accent: '#3498db', name: 'ãƒ¢ãƒ€ãƒ³' },
            warm: { primary: '#d35400', accent: '#f39c12', name: 'ã‚¦ã‚©ãƒ¼ãƒ ' },
            nature: { primary: '#27ae60', accent: '#2ecc71', name: 'ãƒŠãƒãƒ¥ãƒ©ãƒ«' }
        };
        
        // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã®å®šç¾©
        const fontSizes = {
            small: { title: '1.75rem', section: '1.1rem', text: '0.9rem' },
            medium: { title: '2rem', section: '1.25rem', text: '1rem' },
            large: { title: '2.25rem', section: '1.4rem', text: '1.1rem' }
        };
        
        // ç¾åœ¨ã®è¨­å®š
        let currentSettings = {
            logoFile: null,
            logoUrl: null,
            businessName: 'å ã„ã‚µãƒ­ãƒ³ æ˜ŸèŠ±',
            operatorName: 'æ˜Ÿé‡ èŠ±å­',
            colorTheme: 'professional',
            fontSize: 'medium'
        };
        
        // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            loadSettings();
            updatePreview();
        });
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®åˆæœŸåŒ–
        function initializeEventListeners() {
            // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–¢é€£
            const logoUploadArea = document.getElementById('logoUploadArea');
            const logoFileInput = document.getElementById('logoFile');
            
            logoUploadArea.addEventListener('click', () => logoFileInput.click());
            logoFileInput.addEventListener('change', handleLogoUpload);
            
            // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
            logoUploadArea.addEventListener('dragover', handleDragOver);
            logoUploadArea.addEventListener('drop', handleDrop);
            logoUploadArea.addEventListener('dragenter', (e) => {
                e.preventDefault();
                logoUploadArea.classList.add('dragover');
            });
            logoUploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                if (!logoUploadArea.contains(e.relatedTarget)) {
                    logoUploadArea.classList.remove('dragover');
                }
            });
            
            // ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
            document.getElementById('businessName').addEventListener('input', (e) => {
                currentSettings.businessName = e.target.value;
                updatePreview();
            });
            
            document.getElementById('operatorName').addEventListener('input', (e) => {
                currentSettings.operatorName = e.target.value;
                updatePreview();
            });
            
            // ã‚«ãƒ©ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³é¸æŠ
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.color-option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    currentSettings.colorTheme = option.dataset.color;
                    updatePreview();
                });
            });
            
            // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³é¸æŠ
            document.querySelectorAll('.font-size-option').forEach(option => {
                option.addEventListener('click', () => {
                    document.querySelectorAll('.font-size-option').forEach(o => o.classList.remove('selected'));
                    option.classList.add('selected');
                    currentSettings.fontSize = option.dataset.size;
                    updatePreview();
                });
            });
            
            // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
            document.getElementById('templateSettingsForm').addEventListener('submit', handleFormSubmit);
        }
        
        // ãƒ‰ãƒ©ãƒƒã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
        }
        
        // ãƒ‰ãƒ­ãƒƒãƒ—ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        function handleDrop(e) {
            e.preventDefault();
            document.getElementById('logoUploadArea').classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (validateImageFile(file)) {
                    handleLogoFile(file);
                }
            }
        }
        
        // ãƒ­ã‚´ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
        function handleLogoUpload(e) {
            const file = e.target.files[0];
            if (file && validateImageFile(file)) {
                handleLogoFile(file);
            }
        }
        
        // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        function validateImageFile(file) {
            const maxSize = 2 * 1024 * 1024; // 2MB
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];
            
            if (!allowedTypes.includes(file.type)) {
                showAlert('JPEGã¾ãŸã¯PNGå½¢å¼ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚', 'warning');
                return false;
            }
            
            if (file.size > maxSize) {
                showAlert('ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯2MBä»¥ä¸‹ã«ã—ã¦ãã ã•ã„ã€‚', 'warning');
                return false;
            }
            
            return true;
        }
        
        // ãƒ­ã‚´ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
        function handleLogoFile(file) {
            currentSettings.logoFile = file;
            
            // ãƒ•ã‚¡ã‚¤ãƒ«ãƒªãƒ¼ãƒ€ãƒ¼ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆ
            const reader = new FileReader();
            reader.onload = function(e) {
                currentSettings.logoUrl = e.target.result;
                showCurrentLogo(e.target.result);
                updatePreview();
            };
            reader.readAsDataURL(file);
        }
        
        // ç¾åœ¨ã®ãƒ­ã‚´è¡¨ç¤º
        function showCurrentLogo(src) {
            const currentLogoDiv = document.getElementById('currentLogo');
            const currentLogoImg = document.getElementById('currentLogoImg');
            
            currentLogoImg.src = src;
            currentLogoDiv.style.display = 'block';
        }
        
        // ãƒ­ã‚´å‰Šé™¤
        function removeLogo() {
            currentSettings.logoFile = null;
            currentSettings.logoUrl = null;
            document.getElementById('currentLogo').style.display = 'none';
            document.getElementById('logoFile').value = '';
            updatePreview();
        }
        
        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
        function updatePreview() {
            const previewDoc = document.getElementById('previewDocument');
            const previewLogo = document.getElementById('previewLogo');
            const previewBusinessName = document.getElementById('previewBusinessName');
            const previewOperatorName = document.getElementById('previewOperatorName');
            
            // ãƒ­ã‚´ã®æ›´æ–°
            if (currentSettings.logoUrl) {
                const logoImg = previewLogo.querySelector('img');
                logoImg.src = currentSettings.logoUrl;
                previewLogo.style.display = 'block';
            } else {
                previewLogo.style.display = 'none';
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆã®æ›´æ–°
            previewBusinessName.textContent = currentSettings.businessName || 'å±‹å·ãƒ»äº‹æ¥­æ‰€å';
            previewOperatorName.textContent = `é‘‘å®šå£«ï¼š${currentSettings.operatorName || 'é‘‘å®šå£«å'}`;
            
            // ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒã®é©ç”¨
            const theme = colorThemes[currentSettings.colorTheme];
            document.documentElement.style.setProperty('--primary-main', theme.primary);
            document.documentElement.style.setProperty('--success-main', theme.accent);
            
            // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã®é©ç”¨
            const fontSize = fontSizes[currentSettings.fontSize];
            const previewTitle = previewDoc.querySelector('.preview-title');
            const previewSectionTitles = previewDoc.querySelectorAll('.preview-section-title');
            const previewTexts = previewDoc.querySelectorAll('.preview-text');
            
            previewTitle.style.fontSize = fontSize.title;
            previewSectionTitles.forEach(title => title.style.fontSize = fontSize.section);
            previewTexts.forEach(text => text.style.fontSize = fontSize.text);
        }
        
        // è¨­å®šã®èª­ã¿è¾¼ã¿ï¼ˆå°†æ¥çš„ã«APIã‹ã‚‰ï¼‰
        async function loadSettings() {
            try {
                // å°†æ¥çš„ã«ã¯APIã‹ã‚‰è¨­å®šã‚’å–å¾—
                // const response = await fetch('/api/template/settings');
                // const settings = await response.json();
                
                // ç¾åœ¨ã¯åˆæœŸå€¤ã‚’ä½¿ç”¨
                console.log('è¨­å®šã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
            } catch (error) {
                console.error('è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        async function handleFormSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData();
            
            // ãƒ­ã‚´ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ 
            if (currentSettings.logoFile) {
                formData.append('logo_file', currentSettings.logoFile);
            }
            
            // ãã®ä»–ã®è¨­å®šãƒ‡ãƒ¼ã‚¿
            const settingsData = {
                business_name: currentSettings.businessName,
                operator_name: currentSettings.operatorName,
                color_theme: currentSettings.colorTheme,
                font_size: currentSettings.fontSize
            };
            
            formData.append('settings', JSON.stringify(settingsData));
            
            try {
                // ä¿å­˜å‡¦ç†ã®è¡¨ç¤º
                const submitButton = document.querySelector('button[type="submit"]');
                const originalText = submitButton.innerHTML;
                submitButton.innerHTML = '<span class="material-icons" style="font-size: 16px; margin-right: 8px; vertical-align: text-bottom;">hourglass_empty</span>ä¿å­˜ä¸­...';
                submitButton.disabled = true;
                
                // APIã¸ã®é€ä¿¡ï¼ˆå®Ÿè£…äºˆå®šï¼‰
                await new Promise(resolve => setTimeout(resolve, 1000)); // æ¨¡æ“¬çš„ãªé…å»¶
                
                // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                showAlert('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®šãŒæ­£å¸¸ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸã€‚', 'success');
                
                // ãƒœã‚¿ãƒ³ã®å¾©å…ƒ
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
                
            } catch (error) {
                console.error('è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                showAlert('è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚', 'warning');
                
                // ãƒœã‚¿ãƒ³ã®å¾©å…ƒ
                const submitButton = document.querySelector('button[type="submit"]');
                submitButton.innerHTML = '<span class="material-icons" style="font-size: 16px; margin-right: 8px; vertical-align: text-bottom;">save</span>è¨­å®šã‚’ä¿å­˜';
                submitButton.disabled = false;
            }
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒªã‚»ãƒƒãƒˆ
        function resetForm() {
            if (confirm('è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
                // åˆæœŸå€¤ã«æˆ»ã™
                currentSettings = {
                    logoFile: null,
                    logoUrl: null,
                    businessName: 'å ã„ã‚µãƒ­ãƒ³ æ˜ŸèŠ±',
                    operatorName: 'æ˜Ÿé‡ èŠ±å­',
                    colorTheme: 'professional',
                    fontSize: 'medium'
                };
                
                // ãƒ•ã‚©ãƒ¼ãƒ ã®è¡¨ç¤ºã‚’æ›´æ–°
                document.getElementById('businessName').value = currentSettings.businessName;
                document.getElementById('operatorName').value = currentSettings.operatorName;
                document.getElementById('logoFile').value = '';
                document.getElementById('currentLogo').style.display = 'none';
                
                // é¸æŠçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
                document.querySelectorAll('.color-option').forEach(option => {
                    option.classList.toggle('selected', option.dataset.color === 'professional');
                });
                
                document.querySelectorAll('.font-size-option').forEach(option => {
                    option.classList.toggle('selected', option.dataset.size === 'medium');
                });
                
                updatePreview();
                showAlert('è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚', 'success');
            }
        }
        
        // ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
        function showAlert(message, type = 'success') {
            // æ—¢å­˜ã®ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å‰Šé™¤
            const existingAlert = document.querySelector('.alert');
            if (existingAlert) {
                existingAlert.remove();
            }
            
            // æ–°ã—ã„ã‚¢ãƒ©ãƒ¼ãƒˆã‚’ä½œæˆ
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.textContent = message;
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã®ä¸Šã«æŒ¿å…¥
            const form = document.getElementById('templateSettingsForm');
            form.insertBefore(alert, form.firstChild);
            
            // 3ç§’å¾Œã«è‡ªå‹•å‰Šé™¤
            setTimeout(() => {
                alert.remove();
            }, 3000);
        }
    </script>
</body>
</html>